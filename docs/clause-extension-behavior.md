# 文節伸縮（Shift+矢印）仕様（暫定案）

本ドキュメントは、Akaza における文節の伸縮操作（Shift+→ / Shift+←）の
**期待挙動**をまとめた暫定仕様です。一般的なIMEの挙動を参考にしつつ、
「選択中の文節の読み（かな）を1文字単位で伸縮させる」ことを基本原則とします。
（特定IMEとの完全互換は目標としません）

## 用語

- **文節**: 変換候補が提示される単位（例: `わたし｜は｜がっこう`）
- **選択中の文節**: カーソル/ハイライトが当たっている文節
- **読み（かな）**: 変換対象となる文字列（ひらがな）

## 基本原則

1. Shift+→ は **選択中の文節の読みを右へ1文字伸ばす**。
2. Shift+← は **選択中の文節の読みを左へ1文字伸ばす**。
3. 文節の伸縮に伴って **隣接文節は逆方向に1文字縮む**。
4. 伸縮後も **選択中の文節のフォーカスは維持**する。

## 文節選択（← / →）

1. ← / → は **選択中の文節を左右に移動**する。
2. 文節が2つ以上ある場合、押下ごとに **必ず選択が変わる**。
3. 端に到達した場合は **反対側に回り込む**（ラップする）。

## 例（暫定）

### 右に伸ばす（Shift+→）

入力: `わたしはがっこう`  
初期: `わたし｜は｜がっこう`

- 選択: `わたし`  
  Shift+→ 1回: `わたしは｜がっこう`  
  （次の文節「は」から1文字移動）

- 選択: `は`  
  Shift+→ 1回: `わたしはが｜っこう`  
  （次の文節「がっこう」から1文字移動）

### 左に伸ばす（Shift+←）

入力: `わたしはがっこう`  
初期: `わたし｜は｜がっこう`

- 選択: `は`  
  Shift+← 1回: `わた｜しは｜がっこう`  
  （左の文節「わたし」から末尾1文字を移動）

- 選択: `がっこう`  
  Shift+← 1回: `わたし｜はが｜っこう`

## 端の挙動（暫定）

- 右端の文節で Shift+→ を押しても、文節構成は変化しない。
- 左端の文節で Shift+← を押しても、文節構成は変化しない。

## 例外/注意点

- 伸縮によって **隣接文節が消滅**する場合は、文節数が減る。
- サロゲートやマルチバイト文字は **1文字単位**で扱う。
- 変換候補が空の場合は **現状維持**とする。

## 未確定事項

- 実際の挙動に差がある場合は、具体例を基に調整する。
